# This configuration builds a Docker image and deploys to Cloud Run.

stages:
- build
  - name: 'gcr.io/advance-stratum-409704/ai-assistant'  # Replace with your project ID and desired image name
    substitutions:
      _PROJECT_ID: advance-stratum-409704
    steps:
      - name: 'gcr.io/cloud-builders/docker'
        args: ['build', '-t', 'advance-stratum-409704/ai-assistant:latest', '.']
  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['run', 'deploy', 'ai-assistant', '--image', 'advance-stratum-409704/ai-assistant:latest', 
           '--region', 'asia-south2',  # Replace with your desired region
           '--allow-unauthenticated',  # Remove for production!
           --set-env-vars: 'HANDWRITTEN_RECOGNITION_API_KEY=handwritten_recognition', 
               'OPENAI_API_KEY=OPENAI_API_KEY', 
               'SPEECH_TO_TEXT_API_KEY=speech_to_text', 
               'TEXT_TO_SPEECH_API_KEY=text_to_speech', 
               'TRANSLATION_API_KEY=translation']  
    secretEnvVars:
      HANDWRITTEN_RECOGNITION_API_KEY: handwritten_recognition
      OPENAI_API_KEY: OPENAI_API_KEY  
      SPEECH_TO_TEXT_API_KEY: speech_to_text
      TEXT_TO_SPEECH_API_KEY: text_to_speech
      TRANSLATION_API_KEY: translation

